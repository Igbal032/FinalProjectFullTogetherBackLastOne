
@using FinalProjectMain.Models.Entity
@model Product


<section class="singlePage-center">
    <div class="container">
        <div class="row">
            <div class="col-md-3 col-12 col-lg-3 mt-1 col-about-allCategories">

                <ul class="dropdown-menu allCategoriesInNavBar rounded-0" aria-labelledby="navbarDropdown"></ul>
                <ul class="additionalDropdown justify-content-center">
                    @Html.Action("allCategoriesItemPage", "Category")
                </ul>
                <div class="owl-carousel owl-theme">
                    @Html.Action("smallCarousel", "Home")
                </div>
            </div>
            <div class="col-md-9 col-12 col-lg-9 mt-4">
                <div class="row">
                    <div class="col-md-12 col-12 mt-5">
                        <!--  -->
                        <!-- <img src="~/Template/img/h.jpg" style="background-position: center center; background-size: cover" width="100%" alt=""> -->
                        <!--  -->
                        <!-- TODO -->
                    </div>
                </div>
                <div class="row mt-5">
                    <div class="col-md-12 col-lg-6 col-xl-6 col-for-Images">
                        <div class="column">
                            <input type="hidden" value="@Model.Id" id="hiddenProductId" />
                            <div class="col-md-12 col-lg-12 col-12 item-img">

                                <img id="zoom_02" src="~/Template/img/newImg/@Model.imgPath" class="w-100 mainPicture"
                                     data-zoom-image="~/Template/img/newImg/@Model.imgPath" />

                            </div>
                            <div class="col-md-12 col-lg-12 col-12 item-pictures mt-2">
                                <div class="owl-carousel" id="mainItemImmages">
                                    @Html.Action("itemPicturesOwlCarouseInItemPage", "Home")
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 col-lg-6 col-xl-6 col-for-itemInfo">
                        <p class="item-title text-uppercase font-weight-bold">@Model.Name</p>
                        <div class="d-flex justify-content-between row">
                            <form action="@Url.Action("increseStarLevel","Home")" method="post">
                                <input type="hidden" id="hiddenInputForStar" name="Id" value="@Model.Id" />
                                <div class="rate">
                                    <input type="radio" class="starInput" id="star5" name="rate" value="5" />
                                    <label for="star5" title="text">5 stars</label>
                                    <input type="radio" class="starInput" id="star4" name="rate" value="4" />
                                    <label for="star4" title="text">4 stars</label>
                                    <input type="radio" class="starInput" id="star3" name="rate" value="3" />
                                    <label for="star3" title="text">3 stars</label>
                                    <input type="radio" class="starInput" id="star2" name="rate" value="2" />
                                    <label for="star2" title="text">2 stars</label>
                                    <input type="radio" class="starInput" id="star1" name="rate" value="1" />
                                    <label for="star1" title="text">1 star</label>
                                </div>
                            </form>
                            <div class="reviews col-12">
                                <span>(@ViewBag.commentCount Rəylər)</span>
                            </div>
                            <div class="write-review col-12">
                                <a class="text-muted" href="#commentContex"> <span>Rəy Yaz</span></a>
                            </div>
                        </div>
                        <div class="aboutItem mt-3">
                            <p class="text-dark p-item-info">
                                @Model.About
                            </p>
                        </div>
                        <div class="itemPricePart mt-3">
                            <span class="font-weight-bold">@Model.Price AZN</span>
                        </div>
                        @if (Model.isSold == true)
                        {
                            <span class="badge badge-danger badgeItemPage">
                                Satılıb!
                            </span>
                        }
                        @if (Model.isSold == false)
                        {
                            <span class="badge badge-success badgeItemPage">
                                Satılmayıb!
                            </span>
                        }
                        <div class="icons mt-4">

                            <a href="#"><i class="fas fa-shopping-basket" onclick="clickShopIcon(@Model.Id)"></i></a>
                            <a style="cursor:pointer!important" onclick="clickWishlistt(@Model.Id)"><i class="fab fa-gratipay"></i></a>
                            <a class="text-muted icon-link">
                                @*<i class="fas fa-compress-arrows-alt"></i>*@
                                <i class="far fa-star"></i>
                            </a>
                            <span id=spanIdForStar style="position: absolute;left: 153px;top: 265px;color: #ffc107;font-weight: 900;">@Model.starLevel</span>
                        </div>

                        <div class="social-sharing mt-4">
                            <ul class="nav">
                                <li>
                                    <a class="btn btn-sm f rounded-0" href="#">
                                        <i class="fab fa-facebook-f"></i>
                                        Facebook
                                    </a>
                                </li>
                                <li>
                                    <a class="btn btn-sm t rounded-0" href="#">
                                        <i class="fab fa-twitter"></i>
                                        Twitter
                                    </a>
                                </li>
                                <li>
                                    <a class="btn btn-sm g rounded-0" href="#">
                                        <i class="fab fa-google-plus-g"></i>
                                        Google
                                    </a>
                                </li>
                                <li>
                                    <a class="btn btn-sm p rounded-0" href="#">
                                        <i class="fab fa-pinterest"></i>Pinterest
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="tab-single-page mt-5">
                    <div class="input-group">
                        <input type="text" value="" required id="commentContex" class="form-control" />
                        <div class="input-group-append">
                            <button onclick="writeCommentButton()" class="btn btn-sm btn-info">Rəy yaz</button>
                        </div>
                    </div>
                    <ul class="nav nav-tabs font-weight-bold mt-2" id="myTab" role="tablist-product">
                        <li class="nav-item">
                            <a class="nav-link review active" id="contact-tab" data-toggle="tab" href="#comments">RƏYLƏR</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link product-detail" id="profile-tab" data-toggle="tab"
                               href="#product-details" aria-controls="profile" aria-selected="false">
                                MƏHSUL
                                DETAYLARI
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content mt-3" id="myTabContent">
                        <div class="tab-pane fade show active p-3" id="comments" role="tabpanel" aria-labelledby="contact-tab">
                            @Html.Action("CommentPage", "LikeAndComment")
                        </div>
                        <div class="tab-pane fade  p-3" id="product-details" role="tabpanel"
                             aria-labelledby="profile-tab">
                            <span>
                                @Model.About
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="owl carousel-related-product mt-5">
    <div class="container">
        <ul class="nav nav-tabs font-weight-bold">
            <li class="nav-item">
                <a class="active  text-muted" data-toggle="tab" href="#tabCarouselProduct">OXŞAR QABLAR</a>
            </li>
        </ul>

        <div class="tab-content mt-2">
            <div class="owl-carousel" id="owl-carousel">

                @Html.Action("relatedItemsCarousel", "Home")

            </div>
        </div>
    </div>
</section>

@section scripts{
    <script src="~/Template/js/item-js.js"></script>

    <script>

    $('input[type=radio]').on('change', function () {
            $(this).closest("form").submit();
            $(this).css({ "background-color": "yellow" });
        });
    function writeCommentButton() {
        $.ajax({

            url: "@Url.Action("writeCommentButton","LikeAndComment")",
            type: "POST",
            data: {
                productId: $("#hiddenProductId").val(),
                commentContex:$("#commentContex").val(),
            },
            success: function (response) {
                if (response == "nosession")
                {
                    console.log(response)
                    swal({
                         title: "Daxil Olun!",
                         icon: "warning",
                         button: "Daxil Ol!",
                    }).then(function() {
                          window.location.href = "/Home/logIn";
                                 });
                }
                 if (response == "emptyInput") {
                     swal({
                         title: "Zəhmət Olmasa Xananı Doldurun!",
                         icon: "warning",
                         button: "Bagla!",
                    })
                }
                else
                {
                    $("#comments").html(response)
                    $("#commentContex").val("")
                }
            },
            error: function (response) {
                console.error(response)
            }
        })
    }
    function answerMessage(Id) {

        $.ajax({

            url: "@Url.Action("answerMessage","LikeAndComment")",
            type: "POST",
            data: {
                commentId: Id,
                answercomment: $(".asnwerInput").val(),
                productId: $("#hiddenProductId").val(),

            },
            success: function (response) {
                 if (response == "nosession")
                {
                    console.log(response)
                    swal({
                         title: "Daxil Olun!",
                         icon: "warning",
                         button: "Daxil Ol!",
                    }).then(function() {
                          window.location.href = "/Home/logIn";
                                 });
                 }
                 if (response == "emptyInput") {
                     swal({
                         title: "Zəhmət Olmasa Xananı Doldurun!",
                         icon: "warning",
                         button: "Bagla!",
                    })
                }
                else
                {
                    $("#comments").html(response)
                }
            },
            error: function (response) {
                console.error(response)
            }
        })
    }
    function deleteComment(Id) {
        $.ajax({

            url: "@Url.Action("deleteComment","LikeAndComment")",
            type: "POST",
            data: {
                commentId: Id,
                productId: $("#hiddenProductId").val(),
            },
            success: function (response) {
                 if (response == "nosession")
                {
                    console.log(response)
                    swal({
                         title: "Daxil Olun!",
                         icon: "warning",
                         button: "Daxil Ol!",
                    }).then(function() {
                          window.location.href = "/Home/logIn";
                                 });
                 }
                else
                {
                    $("#comments").html(response)
                }
            },
            error: function (response) {
                console.error(response)
            }
        })
    }
    function clickWishlistt(Id) {

            $.ajax({
                url: "@Url.Action("addToMyWishListt","additionalActions")",
                type: "POST",
                data: { id: Id },
                success: function (response) {
                    if (response == "nosession")
                    {
                    swal({
                         title: "Daxil Olun!",
                         icon: "warning",
                         button: "Daxil Ol!",
                    }).then(function() {
                          window.location.href = "/Home/logIn";
                                 });
                    }
                    else if (response == "existsProduct")
                    {
                     swal({
                         text: "Bu məhsul istək listində mövcuddur!",
                         icon: "warning",
                         button: "Bağla!",
                     });
                    }
                    else
                    {
                  swal({
                    text: "Istək Siyahısına Elavə olundu!",
                    icon: "success",
                    button: "Bağla!",
                  });
                    }

                },
                error: function (response) {
                    console.error(response)
                }
            })
            }
    function deleteAsnwerComment(Id) {
                $.ajax({

            url: "@Url.Action("deleteComment","LikeAndComment")",
            type: "POST",
            data: {
                answerCommentId: Id,
                productId: $("#hiddenProductId").val(),
            },
            success: function (response) {
                 if (response == "nosession")
                {
                    console.log(response)
                    swal({
                         title: "Daxil Olun!",
                         icon: "warning",
                         button: "Daxil Ol!",
                    }).then(function() {
                          window.location.href = "/Home/logIn";
                                 });
                 }
                else
                {
                    $("#comments").html(response)
                }
            },
            error: function (response) {
                console.error(response)
            }
        })
    }
    </script>

}