@model FinalProjectMain.Models.Entity.Product

@{
    ViewBag.Title = "Edit";
    Layout = "~/Areas/Admin/Views/Shared/Layout.cshtml";
    var db = new FinalProjectMain.Models.ShoppingDbContext();
    var images = db.imageProducts.Where(w =>w.DeletedDate==null && w.ProductId == Model.Id).ToList();
}


    <div class="container" style="margin-top:100px !important;">
        <div class="row">
            <input type="hidden" value="@Model.Id" id="hiddenProductId" />
            @using (Html.BeginForm("EditSubmit", "EditProducts",FormMethod.Post, new {id = Model.Id,enctype="multipart/form-data"}))
            {
                @Html.AntiForgeryToken()

            <div class="container-fluid">
                <hr />
                @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                @Html.HiddenFor(model => model.Id)

                <div class="form-group">
                    <label>Adı</label>
                    <div class="col-md-10">
                        <input type="text" class="form-control" name="name" value="@Model.Name" />
                    </div>
                </div>

                <div class="form-group">
                    <label>Hakqında</label>
                    <div class="col-md-10">
                        <textarea type="text" name="about" class="form-control">@Model.About</textarea>

                    </div>
                </div>

                <div class="form-group">
                    <label>Qiymət</label>
                    <div class="col-md-10">
                        <input type="text" class="form-control" name="price" value="@Model.Price" />
                    </div>
                </div>

                <div class="form-group">
                    <label for="">Şəkil Seç</label>
                    <input type="file" multiple name="imgFiles" class="form-control-file" id="imgInp" />

                    <p class="text-danger">@TempData["imgIsEmpty"]</p>
                </div>
                <div class="form-group">
                    <div class="col-md-offset-2 col-md-10">
                        <button type="submit" class="btn btn-success">Redakte Et</button>
                    </div>
                </div>
            </div>
            }
        </div>
        <div class="row" id="imagesId">
            <div class="form-group">
                <label>Şəkillər</label>
                <div class="col-md-10 d-flex">
                    @foreach (var item in images)
                    {
                        <img class="mt-2 ml-2" src="~/Template/img/newImg/@item.imgPath" width="200px" />
                        <a onclick="deleteImage(@item.Id)" href="#" style="color:red!important; font-weight:bold !important;">X</a>
                    }
                </div>
            </div>
        </div>
    </div>

@section scripts{
    
    <script>
    function deleteImage(Id) {
        console.log(Id)
        $.ajax({

            url: "@Url.Action("deleteImage","EditProducts")",
            data: {
                imageId: Id,
                productId : $("#hiddenProductId").val()
            },
            type: "POST",
            success: function (response) {
                $("#imagesId").html(response)
            },
            error: function (response) {
                console.error(response)
            }
        })
    }

    </script>
    
    }