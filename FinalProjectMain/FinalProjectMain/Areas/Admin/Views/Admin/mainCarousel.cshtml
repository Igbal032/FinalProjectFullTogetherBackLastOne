@model IEnumerable<FinalProjectMain.Models.Entity.mainCarousel>
@{
    Layout = "~/Areas/Admin/Views/Shared/Layout.cshtml";
}

<div class="container" style="margin-top:100px;">
    <div class="row">
        <div class="col-md-12 col-xl-12 col-lg-12 col-12">
            <form action="@Url.Action("changeMainCarousel","Admin")" method="post" enctype="multipart/form-data">
                <div class="form-group">
                    <label class="image-container">
                        <i class="empty-icon"></i>
                        <a href="javascript:removePhoto()"><i class="clear-icon header-right-button"></i></a>
                        <input type="file" accept="image/*" name="imgPath" onchange="readURL(this)" id="mediaUrl" value="" />
                        <img src="" class="w-25" id="news-image" />
                    </label>
                </div>
                <p class="text-danger font-weight-bold">@TempData["imgIsEmpty"]</p>


                <label>Başlıq</label>
                <input type="text" class="form-control" name="title" value="" placeholder="Başlıq"/>
                <label>Qisa Məlumat</label>
                <textarea class="form-control" name="shortContent" placeholder="Məlumat Yazın.."></textarea>
                <button class="btn btn-md rounded-0 btn-danger mt-1" type="submit">Yadda Saxla</button>
            </form>
        </div>
        <div class="col-md-12 col-xl-12 col-lg-12 col-12">
            <div class="row" id="mainCrouselRowId">
                @foreach (var item in Model)
                {
                <div class="col-md-3 col-lg-3 col-xl-3 col-6 col-12 mt-2">
                    <div class="img-part d-flex">
                        <img src="~/Template/img/mainCarousel/@item.imgPath" class="w-100" />
                        <a href="#" onclick="deleteMainCarouselPicture(@item.Id)" class="text-decoration-none text-danger">X</a>
                    </div>
                    <div class="body-part">
                        <h2>@item.title</h2>
                    </div>
                </div>
                }
            </div>
        </div>
    </div>
</div>


@section scripts{


    <script>
        $(function () {
            $('.validation-summary-errors').each(function () {
                $(this).addClass('alert');
                $(this).addClass('alert-danger');
            });
            $('form').each(function () {
                $(this).find('div.form-group').each(function () {
                    if ($(this).find('span.field-validation-error').length > 0) {
                        $(this).addClass('has-error');
                        $(this).find('span.field-validation-error').
                            removeClass('field-validation-error');
                    }
                });
            });
        });
        var readURL = function (input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    $('#news-image').attr('src', e.target.result);
                }
                reader.readAsDataURL(input.files[0]);
            }
        }
        var removePhoto = function () {
            document.getElementById('mediaUrl').value = '';
            document.getElementById('news-image').src = '';
        }
    </script>
    <script>
    function deleteMainCarouselPicture(Id) {

        $.ajax({

            url: "@Url.Action("deleteMainCarouselPicture","Admin")",
            type: "POST",
            data: { pictureId: Id },
            success: function (response) {
                    swal({
                        title: "Şəkil Silindi!",
                        icon: "success",
                        button: "Bağla!",
                    });
            $("#mainCrouselRowId").html(response)
            },
            error: function (response) {
                console.error(response)
            }
        })
    }
    </script>

}